---
title: "**Parallel Analysis Report**"
output: html_document
params:
  dumbbell_plot_path: NA
  ri_plot_path: NA
  density_plot_path: NA
  box_plot_path: NA
  summary_text: "No summary available."
  individual_plots: list()
  individual_summaries: list()
---

<style>
body {
  font-family: Helvetica;
  line-height: 1.6;
}
h1, h2, h3 {
  color: #333;
}
/*
  This is a forceful override for all pre-formatted text blocks.
  It targets the <pre> tag directly and uses !important to ensure
  these styles are not overridden by the PDF rendering engine's defaults.
*/
pre {
  font-size: 9px !important;
  font-family: Helvetica, sans-serif !important;
  white-space: pre-wrap !important;
  word-wrap: break-word !important;
  background-color: #f5f5f5 !important;
  border: 1px solid #ddd !important;
  padding: 15px !important;
  border-radius: 5px !important;
}
@page {
  @bottom-right {
    content: "Page " counter(page) " of " counter(pages);
    font-size: 10px;
  }
}
</style>

#### Analysis performed on `r format(Sys.time(), '%Y-%m-%d %H:%M:%S')`

---

## Combined Analysis Plots

### Dumbbell Plot of Reference Intervals

![Dumbbell Plot](`r params$dumbbell_plot_path`)

### Combined Reference Intervals Plot

![RI Plot](`r params$ri_plot_path`)

### Combined Density Plot

![Density Plot](`r params$density_plot_path`)

### Combined Box Plot

![Box Plot](`r params$box_plot_path`)

---

## Combined Summary

```{r, results='asis', echo=FALSE}
cat(params$summary_text)

## Individual Subpopulation Results

if (length(params$individual_plots) > 0) {
  for (i in seq_along(params$individual_plots)) {
    cat("### Subpopulation Plot\n\n")
    cat(paste0("![Subpopulation Plot ", i, "](", params$individual_plots[[i]], ")\n\n"))
    
    cat("### Subpopulation Summary\n\n")
    cat("```\n")
    cat(params$individual_summaries[[i]])
    cat("\n```\n\n")
    
    cat("<hr>\n\n")
  }
} else {
  cat("No individual results were generated or available for the report.\n")
}